<div class="row">
    <div class="col-12">
        <div class="card h-100">
            <div class="card-header d-flex justify-content-between align-items-center">
                <span>Car Maintenances Table</span>

                <button class="btn btn-primary" style="padding: 6px 12px;" (click)="displayAddModal();">
                    <small><b>Add</b></small>
                </button>
            </div>
            <div class="card-body ">
                <table class="table">
                    <thead class="text-secondary text-center">
                        <th>#</th>
                        <th>Name</th>
                        <th>Mobile</th>
                        <th>Second Mobile</th>
                        <th>Address</th>
                        <th>Brands</th>
                        <th>Action</th>
                    </thead>
                    <tbody class="text-center">
                        <tr *ngFor="let maintenance of maintenances; let i = index">
                            <td>{{i+1}}</td>
                            <td>{{maintenance.name}}</td>
                            <td>{{maintenance.mobile}}</td>
                            <td>{{maintenance.phone}}</td>
                            <td>{{maintenance.address}}</td>
                            <td>
                                <div *ngFor="let brand of maintenance.brands; let i = index">
                                    {{brand?.car?.car_name}}
                                    <i class="fa-regular fa-trash-can ml-2 text-danger pointer"
                                        (click)="deleteBrand(brand?.car?.id,maintenance.id)"></i>
                                </div>
                            </td>
                            <td>
                                <button class="btn btn-primary m-1" (click)="displayBrandModal(maintenance)">Add
                                    Brand</button>
                                <!-- <button class="btn btn-danger m-1" (click)="deleteBrand(maintenance)">Delete
                                    Brand</button> -->
                                <button class="btn btn-info m-1" (click)="displayUpdateModal(maintenance)">Edit</button>
                                <button class="btn btn-danger m-1"
                                    (click)="deleteConfirm(maintenance.id)">Delete</button>
                            </td>
                        </tr>
                    </tbody>
                </table>
                <ngb-pagination [collectionSize]="pagination?.total" [page]="pagination?.current_page"
                    (pageChange)="loadPage($event)" [pageSize]="pagination?.per_page">
                </ngb-pagination>
            </div>
        </div>
    </div>
</div>

<p-dialog header="Add Maintenances" [(visible)]="addModal" [modal]="true" [style]="{width: '50vw'}" [draggable]="false"
    [resizable]="false">
    <form [formGroup]='maintenanceForm' (ngSubmit)='addMaintenance(maintenanceForm)' id="addForm">
        <div class="row mx-0">
            <div class="col-12">
                <div class="form-group">
                    <label>Name</label>
                    <input type="text" class="form-control" placeholder="Enter Engineer Name" formControlName='name'>
                </div>
            </div>
            <div class="col-12">
                <div class="form-group">
                    <label>Mobile</label>
                    <input type="text" class="form-control" placeholder="Enter Engineer Mobile"
                        formControlName='mobile'>
                </div>
            </div>
            <div class="col-12">
                <div class="form-group">
                    <label>Address</label>
                    <input type="text" class="form-control" placeholder="Enter Engineer Address"
                        formControlName='address'>
                </div>
            </div>
            <div class="col-12">
                <div class="form-group">
                    <label>Second Mobile</label>
                    <input type="text" class="form-control" placeholder="Enter Engineer Second Mobile"
                        formControlName='phone'>
                </div>
            </div>
        </div>
    </form>
    <ng-template pTemplate="footer">
        <button class="btn btn-primary m-1" form="addForm">Create</button>
    </ng-template>
</p-dialog>

<p-dialog header="Edit Maintenances" [(visible)]="editModal" [modal]="true" [style]="{width: '50vw'}"
    [draggable]="false" [resizable]="false">
    <form [formGroup]='maintenanceForm' (ngSubmit)='editMaintenance(maintenanceForm)' id="editForm">
        <div class="row mx-0">
            <div class="col-12">
                <div class="form-group">
                    <label>Name</label>
                    <input type="text" class="form-control" placeholder="Enter Engineer Name" formControlName='name'>
                </div>
            </div>
            <div class="col-12">
                <div class="form-group">
                    <label>Mobile</label>
                    <input type="text" class="form-control" placeholder="Enter Engineer Mobile"
                        formControlName='mobile'>
                </div>
            </div>
            <div class="col-12">
                <div class="form-group">
                    <label>Address</label>
                    <input type="text" class="form-control" placeholder="Enter Engineer Address"
                        formControlName='address'>
                </div>
            </div>
            <div class="col-12">
                <div class="form-group">
                    <label>Second Mobile</label>
                    <input type="text" class="form-control" placeholder="Enter Engineer Second Mobile"
                        formControlName='phone'>
                </div>
            </div>
        </div>
    </form>
    <ng-template pTemplate="footer">
        <button class="btn btn-primary m-1" form="editForm">Update</button>
    </ng-template>
</p-dialog>

<p-dialog header="Add Maintenance Brand" [(visible)]="addBrandModal" [modal]="true" [style]="{width: '50vw'}"
    [draggable]="false" [resizable]="false">
    <div class="row mx-0">
        <!-- <div class="col-12">
            <div class="form-group">
                <label>Brands</label>
                <p-dropdown [options]="cars" optionLabel="car_name" styleClass="w-100" optionValue="id" #brandsDropdown
                    placeholder="Select Brand" appendTo="body">
                </p-dropdown>
            </div>
        </div> -->
        <div class="col-12">
            <span class="p-float-label">
                <p-multiSelect inputId="multiselect" [options]="cars" optionLabel="car_name" [filter]="true"
                    appendTo="body" optionValue="id" #brandsDropdown styleClass="w-100">
                </p-multiSelect>
                <label for="multiselect">Select Brand</label>
            </span>
        </div>
    </div>
    <ng-template pTemplate="footer">
        <button class="btn btn-primary m-1" (click)="addBrandForMaintenanceCenter(brandsDropdown)">Add Brand</button>
    </ng-template>
</p-dialog>

<p-confirmDialog [style]="{width: '50vw'}" [baseZIndex]="10000" rejectButtonStyleClass="p-button-text">
</p-confirmDialog>